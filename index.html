<html>
<head>
	<title>Richard Quan (NetID: rq32)</title>
	<link href='https://fonts.googleapis.com/css?family=PT+Sans' rel='stylesheet' type='text/css'>
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	<script src="http://d3js.org/topojson.v1.min.js"></script>
	<style>
	body { font-family: 'PT Sans', sans-serif; background-color: grey; } div { margin: 30px; }
	h1 {font-family: 'PT Sans', sans-serif; color: white;}
	h3 { font-family: 'PT Sans', sans-serif; color: white; font-size: 16}
	svg { border: none; fill: black;}
	.axis path { fill: none; stroke:  #f8f8ff; stroke-opacity: 1;}
	.axis line { stroke:  #f8f8ff; stroke-opacity: 1;}
	.axis text { font-size: 0.5em; fill: #f8f8ff; opacity: 1;}
	.noTextAxis text { font-size: 0em; }  
	.logAxis text { font-size: 0.3em; } 
	text {fill-opacity : 1;}
	circle {fill-opacity : 0.8;}
	line {opacity : 1;}
}
	
	</style>
</head>
<body>
	<h3>CS/INFO 3300 / INFO 5100</h3>
	<h3>Project 1</h3>
	<h3>Richard Quan (rq32), Akshay Tata(at758), YuanYuan Li(yl2577)</h3>
	<h1>Average Cost per Hospital for Top 100 Diagnoses in the United States</h1>

	<p id="p2output">
	<script>

		//TODO: old background color : rgb(39,40,34), old axis color: #B1FB17
		//TODO: remove comments

		var svg2a = d3.select("#p2output").append("svg");
		svg2a.attr("height",1500).attr("width",1000);


		svg2a.append("rect")
		.attr("height","1000")
		.attr("width", "1000")
		.style("fill", "none");
		//rgb(9, 52, 86)
		
		/*var str = '';
		console.log('hello\n\n\n\n');
		for(var i = 0; i < 96; i++) {
			var Red = i % 4;
			var Grn = (i / 4) % 4;
			var Blu = (i / 16) % 4;

			Red = Math.floor(Red * 255 / 3);
			Grn = Math.floor(Grn * 255 / 3);
			Blu = Math.floor(Blu * 255 / 3);
			
			str += 'rgb('+Red+','+Grn+','+Blu+')\n';
		}
		console.log(str);*/

		var topPad = 10;
		var botPad = 30;
		var leftPad = 40;
		var rightPad = 10;
		var height = svg2a.attr("height")-topPad-botPad;
		var width = svg2a.attr("width")-leftPad-rightPad;
		var xScale = d3.scale.linear().domain([10000,60000]).range([0, width]);
		var yScale = d3.scale.linear().domain([10000,125000]).range([height, 0]);

		var radScale = d3.scale.linear().domain([18250, 58000]).range([20, 35]);
		var opacityScale = d3.scale.linear().domain([9000, 150000]).range([0.2, 1]);




		/*var xAxis = d3.svg.axis().scale(xScale).orient("bottom").tickFormat(d3.format("s"));
		svg2a.append("g").attr("class", "axis")
		.attr("transform", "translate("+leftPad+","+(height+topPad)+")")
		.call(xAxis);*/

		var yAxis = d3.svg.axis().scale(yScale).orient("left").tickFormat(d3.format("s"));
		svg2a.append("g").attr("class", "axis")
		.attr("transform", "translate("+leftPad+","+topPad+")")
		.call(yAxis);

		var yearCnt = 0;
		var yearCntGreen = 0;
		var ctrVar = 0;

		var xArr = [xScale(52062.94) - 650, xScale(59444.46) - 550, xScale(66698.56) - 450];

		var hashObj = {};

		var dischargeText = "\"Total No. of discharges billed\"";

		var avgtotText = "\"Avg. Medicare Paym. to the Provider\"";

		var avgCharge = "\"Avg. charge, provider billed to Medicare\"";

		svg2a.append("line")
			.attr("stroke", " #E4287C")
			.attr("stroke-width", "1")
			.attr("x1", xArr[1] - 100)
			.attr("y1", topPad)
			.attr("x2", xArr[1] - 100)
			.attr("opacity", "0.5")
			.attr("y2", 1000 - topPad - botPad);

		svg2a.append("line")
			.attr("stroke", " #E4287C")
			.attr("stroke-width", "1")
			.attr("x1", xArr[2] - 100)
			.attr("y1", topPad)
			.attr("opacity", "0.5")
			.attr("x2", xArr[2] - 100)
			.attr("y2", 1000 - topPad - botPad);

		svg2a.append("line")
			.attr("stroke", " #E4287C")
			.attr("stroke-width", "1")
			.attr("x1", xArr[2] + 130)
			.attr("y1", topPad)
			.attr("opacity", "0.5")
			.attr("x2", xArr[2] + 130)
			.attr("y2", 1000 - topPad - botPad);

		svg2a.append("text")
			.text("2011")
			.attr("font-size",20)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","#f8f8ff")
			.attr("x", 150)//x
			.attr("y", 1000 - topPad - botPad - 940);//y

		svg2a.append("text")
			.text("2012")
			.attr("font-size",20)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","#f8f8ff")
			.attr("x", 400)//x
			.attr("y", 1000 - topPad - botPad - 940);//y

		svg2a.append("text")
			.text("2013")
			.attr("font-size",20)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","#f8f8ff")
			.attr("x", 630)//x
			.attr("y", 1000 - topPad - botPad - 940);//y

		svg2a.append("text")
			.text("Key")
			.attr("font-size",20)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","#f8f8ff")
			.attr("x", 880)//x
			.attr("y", 1000 - topPad - botPad - 940);//y

	/*	svg2a.append("circle")
				.attr("cx", 880)
				.attr("cy", 100)
				.attr("r", 35)
				.attr("fill", "#493D26")
				.attr("fill-opacity", 1);

		svg2a.append("text")
			.text("Avg.Coverage")
			.attr("font-size",11)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","#f8f8ff")
			.attr("x", 880)//x
			.attr("y", 105);//y

		svg2a.append("text")
			.text("Discharges")
			.attr("font-size",11)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","#f8f8ff")
			.attr("x", 880)//x
			.attr("y", 90);//y
			*/


		/*	svg2a.append("text")
			.text("Y-Axis")
			.attr("font-size",13)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","#B1FB17")
			.attr("x", 880)//x
			.attr("y", 400);//y

		svg2a.append("text")
			.text("Total Payments in Dollars")
			.attr("font-size",13)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","#B1FB17")
			.attr("x", 880)//x
			.attr("y", 420);//y

		svg2a.append("text")
			.text(avgtotText)
			.attr("font-size",12)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","white")
			.attr("x", 880)//x
			.attr("y", 440);//y

		svg2a.append("text")
			.text("DRG Procedures")
			.attr("font-size",13)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","#f8f8ff")
			.attr("x", 880)//x
			.attr("y", 550);//y
			*/

		/*svg2a.append("text")
			.text("Discharges")
			.attr("font-size",13)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","#f8f8ff")
			.attr("x", 880)//x
			.attr("y", 220);//y

		svg2a.append("text")
			.text(dischargeText)
			.attr("font-size",11)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","white")
			.attr("x", 880)//x
			.attr("y", 240);//y

		svg2a.append("text")
			.text("Average Coverage in Dollars")
			.attr("font-size",13)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","#f8f8ff")
			.attr("x", 880)//x
			.attr("y", 300);//y

		svg2a.append("text")
			.text(avgCharge)
			.attr("font-size",12)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","white")
			.attr("x", 880)//x
			.attr("y", 320);//y
			*/

		/*svg2a.append("text")
			.text("MCC = Major Complications")
			.attr("font-size",12)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","#f8f8ff")
			.attr("x", 880)//x
			.attr("y", 480);//y

		svg2a.append("text")
			.text("CC = Complications")
			.attr("font-size",12)
			.attr("text-anchor","middle")
			.attr("alignment-baseline","middle")
			.attr("fill","#f8f8ff")
			.attr("x", 880)//x
			.attr("y", 500);//y*/
				
		//var yearPayName = ["year2011", "year2012", "year2013"];
		var cntName = 580;
		var totWordCtr = 0;

		var drgData;

		d3.json("medicaldata.json", function(error, json) {
  			if (error) return console.warn(error);
  			drgData = json;
		

		drgData.forEach(function (word) {

				svg2a.append("circle")
				.attr("cx", xArr[0]+leftPad)
				.attr("cy", yScale(word.year2011)+topPad)
				.attr("r", 5)
				.attr("fill", word.color)
				.attr("fill-opacity", opacityScale(word.year2011));
				//.attr("transform", "translate("+tranCtr+", 0)");

				svg2a.append("circle")
				.attr("cx", xArr[1]+leftPad)
				.attr("cy", yScale(word.year2012)+topPad)
				.attr("r", 5)
				.attr("fill", word.color)
				.attr("fill-opacity", opacityScale(word.year2012));
				//.attr("transform", "translate("+tranCtr+", 0)");

				svg2a.append("circle")
				.attr("cx", xArr[2]+leftPad)
				.attr("cy", yScale(word.year2013)+topPad)
				.attr("r", 5)
				.attr("fill", word.color)
				.attr("fill-opacity", opacityScale(word.year2013));
				//.attr("transform", "translate("+tranCtr+", 0)");
			
			});
});

	</script>
	</p>

</body>
</html>